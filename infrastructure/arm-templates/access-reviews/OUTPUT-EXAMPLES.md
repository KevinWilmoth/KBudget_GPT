# Access Review Output Examples

This document provides examples of the reports and outputs generated by the access review script.

## Example: Script Execution Output

```
================================================================================
Azure Access Review Script
================================================================================

[INFO] 2026-02-14 10:15:30 - Start Time: 2026-02-14 10:15:30
[INFO] 2026-02-14 10:15:30 - Review ID: AR-2026-Q1-0214
[INFO] 2026-02-14 10:15:30 - Review Type: Quarterly
[INFO] 2026-02-14 10:15:30 - Environment(s): all
[INFO] 2026-02-14 10:15:30 - Output Format: All

================================================================================
Checking Prerequisites
================================================================================

[INFO] 2026-02-14 10:15:31 - Checking for Azure PowerShell module...
[SUCCESS] 2026-02-14 10:15:31 - Azure PowerShell module found
[INFO] 2026-02-14 10:15:31 - Checking Azure authentication...
[SUCCESS] 2026-02-14 10:15:32 - Authenticated as: admin@example.com
[INFO] 2026-02-14 10:15:32 - Subscription: KBudget-Production

[INFO] 2026-02-14 10:15:32 - Reviewing environments: dev, staging, prod

================================================================================
Collecting Access Review Data - Development
================================================================================

[INFO] 2026-02-14 10:15:33 - Retrieving role assignments for kbudget-dev-rg...
[SUCCESS] 2026-02-14 10:15:35 - Found 23 role assignments
[SUCCESS] 2026-02-14 10:15:38 - Data collection complete:
[INFO] 2026-02-14 10:15:38 -   - Users: 8
[INFO] 2026-02-14 10:15:38 -   - Groups: 3
[INFO] 2026-02-14 10:15:38 -   - Service Principals: 12
[WARNING] 2026-02-14 10:15:38 -   - High-Privilege Accounts: 5
[WARNING] 2026-02-14 10:15:38 -   - Orphaned Assignments: 1
[WARNING] 2026-02-14 10:15:38 -   - Findings: 2

================================================================================
Collecting Access Review Data - Staging
================================================================================

[INFO] 2026-02-14 10:15:39 - Retrieving role assignments for kbudget-staging-rg...
[SUCCESS] 2026-02-14 10:15:41 - Found 18 role assignments
[SUCCESS] 2026-02-14 10:15:43 - Data collection complete:
[INFO] 2026-02-14 10:15:43 -   - Users: 5
[INFO] 2026-02-14 10:15:43 -   - Groups: 2
[INFO] 2026-02-14 10:15:43 -   - Service Principals: 11
[WARNING] 2026-02-14 10:15:43 -   - High-Privilege Accounts: 3
[SUCCESS] 2026-02-14 10:15:43 -   - Orphaned Assignments: 0
[WARNING] 2026-02-14 10:15:43 -   - Findings: 1

================================================================================
Collecting Access Review Data - Production
================================================================================

[INFO] 2026-02-14 10:15:44 - Retrieving role assignments for kbudget-prod-rg...
[SUCCESS] 2026-02-14 10:15:46 - Found 15 role assignments
[SUCCESS] 2026-02-14 10:15:48 - Data collection complete:
[INFO] 2026-02-14 10:15:48 -   - Users: 3
[INFO] 2026-02-14 10:15:48 -   - Groups: 1
[INFO] 2026-02-14 10:15:48 -   - Service Principals: 11
[WARNING] 2026-02-14 10:15:48 -   - High-Privilege Accounts: 2
[SUCCESS] 2026-02-14 10:15:48 -   - Orphaned Assignments: 0
[WARNING] 2026-02-14 10:15:48 -   - Findings: 3

================================================================================
Access Review Summary
================================================================================

[INFO] 2026-02-14 10:15:49 - Review ID: AR-2026-Q1-0214
[INFO] 2026-02-14 10:15:49 - Review Type: Quarterly
[INFO] 2026-02-14 10:15:49 - Review Date: 2026-02-14
[INFO] 2026-02-14 10:15:49 -
[INFO] 2026-02-14 10:15:49 - Overall Statistics:
[INFO] 2026-02-14 10:15:49 -   - Total Users: 16
[INFO] 2026-02-14 10:15:49 -   - Total Groups: 6
[INFO] 2026-02-14 10:15:49 -   - Total Service Principals: 34
[WARNING] 2026-02-14 10:15:49 -   - High-Privilege Accounts: 10
[WARNING] 2026-02-14 10:15:49 -   - Orphaned Assignments: 1
[WARNING] 2026-02-14 10:15:49 -   - Total Findings: 6
[INFO] 2026-02-14 10:15:49 -
[INFO] 2026-02-14 10:15:49 - Development Environment:
[INFO] 2026-02-14 10:15:49 -   - Users: 8
[INFO] 2026-02-14 10:15:49 -   - Service Principals: 12
[INFO] 2026-02-14 10:15:49 -   - High-Privilege: 5
[INFO] 2026-02-14 10:15:49 -   - Findings: 2 (Critical: 1, High: 1)
[INFO] 2026-02-14 10:15:49 -
[INFO] 2026-02-14 10:15:49 - Staging Environment:
[INFO] 2026-02-14 10:15:49 -   - Users: 5
[INFO] 2026-02-14 10:15:49 -   - Service Principals: 11
[INFO] 2026-02-14 10:15:49 -   - High-Privilege: 3
[INFO] 2026-02-14 10:15:49 -   - Findings: 1 (Critical: 0, High: 1)
[INFO] 2026-02-14 10:15:49 -
[INFO] 2026-02-14 10:15:49 - Production Environment:
[INFO] 2026-02-14 10:15:49 -   - Users: 3
[INFO] 2026-02-14 10:15:49 -   - Service Principals: 11
[INFO] 2026-02-14 10:15:49 -   - High-Privilege: 2
[INFO] 2026-02-14 10:15:49 -   - Findings: 3 (Critical: 1, High: 2)
[INFO] 2026-02-14 10:15:49 -
[ERROR] 2026-02-14 10:15:49 - CRITICAL FINDINGS REQUIRE IMMEDIATE ATTENTION:
[ERROR] 2026-02-14 10:15:49 -   - Service principal has Owner role (kbudget-dev-automation)
[ERROR] 2026-02-14 10:15:49 -     Action: Reduce to Contributor or resource-specific role
[ERROR] 2026-02-14 10:15:49 -   - Service principal has Owner role (kbudget-prod-cicd)
[ERROR] 2026-02-14 10:15:49 -     Action: Reduce to Contributor or resource-specific role
[INFO] 2026-02-14 10:15:49 -

================================================================================
Exporting Access Review Reports
================================================================================

[SUCCESS] 2026-02-14 10:15:50 - JSON report exported: reports/access_review_AR-2026-Q1-0214_20260214_101530.json
[SUCCESS] 2026-02-14 10:15:51 - Users CSV exported: reports/access_review_AR-2026-Q1-0214_20260214_101530_users.csv
[SUCCESS] 2026-02-14 10:15:51 - Service Principals CSV exported: reports/access_review_AR-2026-Q1-0214_20260214_101530_service_principals.csv
[SUCCESS] 2026-02-14 10:15:52 - High-Privilege Accounts CSV exported: reports/access_review_AR-2026-Q1-0214_20260214_101530_high_privilege.csv
[SUCCESS] 2026-02-14 10:15:52 - Orphaned Assignments CSV exported: reports/access_review_AR-2026-Q1-0214_20260214_101530_orphaned.csv
[SUCCESS] 2026-02-14 10:15:52 - Findings CSV exported: reports/access_review_AR-2026-Q1-0214_20260214_101530_findings.csv
[SUCCESS] 2026-02-14 10:15:53 - Excel report exported: reports/access_review_AR-2026-Q1-0214_20260214_101530.xlsx

================================================================================
Generating Sign-Off Template
================================================================================

[SUCCESS] 2026-02-14 10:15:54 - Sign-off template created: templates/access_review_signoff_AR-2026-Q1-0214.txt

================================================================================
Access Review Complete
================================================================================

[INFO] 2026-02-14 10:15:54 - End Time: 2026-02-14 10:15:54
[INFO] 2026-02-14 10:15:54 - Log file: logs/access_review_AR-2026-Q1-0214_20260214_101530.log
[INFO] 2026-02-14 10:15:54 - Reports directory: reports
[INFO] 2026-02-14 10:15:54 - Sign-off template: templates
[INFO] 2026-02-14 10:15:54 -
[INFO] 2026-02-14 10:15:54 - Next Steps:
[INFO] 2026-02-14 10:15:54 - 1. Review the generated reports
[INFO] 2026-02-14 10:15:54 - 2. Validate findings with resource owners
[INFO] 2026-02-14 10:15:54 - 3. Implement remediation actions
[INFO] 2026-02-14 10:15:54 - 4. Complete the sign-off template
[INFO] 2026-02-14 10:15:54 - 5. Archive documentation for compliance
```

## Example: JSON Report Structure

```json
{
  "ReviewId": "AR-2026-Q1-0214",
  "ReviewDate": "2026-02-14",
  "ReviewType": "Quarterly",
  "GeneratedAt": "2026-02-14 10:15:50",
  "Environments": [
    {
      "Environment": "Development",
      "ResourceGroup": "kbudget-dev-rg",
      "ReviewDate": "2026-02-14",
      "ReviewId": "AR-2026-Q1-0214",
      "Users": [
        {
          "DisplayName": "John Doe",
          "SignInName": "john.doe@example.com",
          "ObjectType": "User",
          "ObjectId": "12345678-1234-1234-1234-123456789012",
          "RoleDefinitionName": "Contributor",
          "Scope": "/subscriptions/sub-id/resourceGroups/kbudget-dev-rg",
          "ResourceGroupName": "kbudget-dev-rg",
          "Environment": "dev",
          "UserPrincipalName": "john.doe@example.com",
          "Mail": "john.doe@example.com",
          "AccountEnabled": true
        }
      ],
      "ServicePrincipals": [
        {
          "DisplayName": "kbudget-dev-app",
          "ObjectType": "ServicePrincipal",
          "ObjectId": "87654321-4321-4321-4321-210987654321",
          "RoleDefinitionName": "Storage Blob Data Contributor",
          "Scope": "/subscriptions/sub-id/resourceGroups/kbudget-dev-rg/providers/Microsoft.Storage/storageAccounts/kbudgetdevstorage",
          "ResourceGroupName": "kbudget-dev-rg",
          "Environment": "dev",
          "ApplicationId": "abcdef12-3456-7890-abcd-ef1234567890",
          "ServicePrincipalType": "Application",
          "SecretExpiration": "2026-12-31T23:59:59Z",
          "DaysUntilSecretExpiry": 321
        }
      ],
      "HighPrivilegeAccounts": [
        {
          "DisplayName": "kbudget-dev-automation",
          "ObjectType": "ServicePrincipal",
          "RoleDefinitionName": "Owner",
          "Scope": "/subscriptions/sub-id/resourceGroups/kbudget-dev-rg",
          "Environment": "dev"
        }
      ],
      "OrphanedAssignments": [
        {
          "DisplayName": "Deleted User",
          "ObjectId": "00000000-0000-0000-0000-000000000000",
          "RoleDefinitionName": "Reader",
          "IsOrphaned": true
        }
      ],
      "Findings": [
        {
          "Severity": "Critical",
          "Type": "ServicePrincipalWithOwnerRole",
          "Principal": "kbudget-dev-automation",
          "Description": "Service principal has Owner role",
          "RecommendedAction": "Reduce to Contributor or resource-specific role"
        },
        {
          "Severity": "High",
          "Type": "ServicePrincipalSecretExpiring",
          "Principal": "kbudget-dev-legacy",
          "Description": "Service principal secret expires in 25 days",
          "RecommendedAction": "Rotate service principal secret"
        }
      ],
      "Summary": {
        "TotalAssignments": 23,
        "UserCount": 8,
        "GroupCount": 3,
        "ServicePrincipalCount": 12,
        "HighPrivilegeCount": 5,
        "OrphanedCount": 1,
        "FindingsCount": 2,
        "CriticalFindings": 1,
        "HighFindings": 1
      }
    }
  ],
  "Summary": {
    "TotalUsers": 16,
    "TotalGroups": 6,
    "TotalServicePrincipals": 34,
    "TotalHighPrivilege": 10,
    "TotalOrphaned": 1,
    "TotalFindings": 6,
    "CriticalFindings": 2,
    "HighFindings": 4
  }
}
```

## Example: Users CSV

```csv
DisplayName,SignInName,UserPrincipalName,ObjectType,RoleDefinitionName,Scope,Environment,AccountEnabled,IsOrphaned
John Doe,john.doe@example.com,john.doe@example.com,User,Contributor,/subscriptions/sub-id/resourceGroups/kbudget-dev-rg,dev,True,
Jane Smith,jane.smith@example.com,jane.smith@example.com,User,Reader,/subscriptions/sub-id/resourceGroups/kbudget-dev-rg,dev,True,
Bob Johnson,bob.johnson@example.com,bob.johnson@example.com,User,Owner,/subscriptions/sub-id/resourceGroups/kbudget-dev-rg,dev,True,
Alice Williams,alice.williams@example.com,alice.williams@example.com,User,Contributor,/subscriptions/sub-id/resourceGroups/kbudget-staging-rg,staging,True,
```

## Example: Service Principals CSV

```csv
DisplayName,ApplicationId,ObjectType,RoleDefinitionName,Scope,Environment,ServicePrincipalType,SecretExpiration,DaysUntilSecretExpiry
kbudget-dev-app,abcdef12-3456-7890-abcd-ef1234567890,ServicePrincipal,Storage Blob Data Contributor,/subscriptions/sub-id/resourceGroups/kbudget-dev-rg/providers/Microsoft.Storage/storageAccounts/kbudgetdevstorage,dev,Application,2026-12-31T23:59:59Z,321
kbudget-dev-automation,12345678-90ab-cdef-1234-567890abcdef,ServicePrincipal,Owner,/subscriptions/sub-id/resourceGroups/kbudget-dev-rg,dev,Application,2027-01-15T23:59:59Z,336
kbudget-dev-legacy,98765432-10ab-cdef-9876-543210abcdef,ServicePrincipal,Contributor,/subscriptions/sub-id/resourceGroups/kbudget-dev-rg,dev,Application,2026-03-10T23:59:59Z,25
```

## Example: High-Privilege Accounts CSV

```csv
DisplayName,SignInName,ObjectType,RoleDefinitionName,Scope,Environment
Bob Johnson,bob.johnson@example.com,User,Owner,/subscriptions/sub-id/resourceGroups/kbudget-dev-rg,dev
kbudget-dev-automation,,ServicePrincipal,Owner,/subscriptions/sub-id/resourceGroups/kbudget-dev-rg,dev
DevOps Team,,Group,Contributor,/subscriptions/sub-id/resourceGroups/kbudget-dev-rg,dev
kbudget-prod-cicd,,ServicePrincipal,Owner,/subscriptions/sub-id/resourceGroups/kbudget-prod-rg,prod
Security Admin,security.admin@example.com,User,Contributor,/subscriptions/sub-id/resourceGroups/kbudget-prod-rg,prod
```

## Example: Findings CSV

```csv
Severity,Type,Principal,Description,RecommendedAction
Critical,ServicePrincipalWithOwnerRole,kbudget-dev-automation,Service principal has Owner role,Reduce to Contributor or resource-specific role
High,ServicePrincipalSecretExpiring,kbudget-dev-legacy,Service principal secret expires in 25 days,Rotate service principal secret
Critical,ServicePrincipalWithOwnerRole,kbudget-prod-cicd,Service principal has Owner role,Reduce to Contributor or resource-specific role
High,ServicePrincipalSecretExpiring,kbudget-prod-backup,Service principal secret expires in 15 days,Rotate service principal secret
High,ServicePrincipalSecretExpiring,kbudget-staging-monitor,Service principal secret expires in 28 days,Rotate service principal secret
```

## Example: Orphaned Assignments CSV

```csv
DisplayName,ObjectId,ObjectType,RoleDefinitionName,Scope,Environment,IsOrphaned
Deleted User,00000000-0000-0000-0000-000000000000,User,Reader,/subscriptions/sub-id/resourceGroups/kbudget-dev-rg,dev,True
```

## Example: Sign-Off Template

```
================================================================================
AZURE ACCESS REVIEW - APPROVAL FORM
================================================================================

Review ID: AR-2026-Q1-0214
Review Date: 2026-02-14
Review Type: Quarterly
Environment(s): All (Development, Staging, Production)

Review Summary:
---------------
Total Accounts Reviewed: 56
  - Users: 16
  - Groups: 6
  - Service Principals: 34

Findings:
---------
Critical: 2
High: 4
Medium: 0
Low: 0

Remediation Actions Taken:
--------------------------
Access Removed: ___________
Permissions Reduced: ___________
Documentation Updated: ___________
No Action Required: ___________

Outstanding Issues:
-------------------
☐ None
☐ List attached

Compliance Status:
------------------
☑ SOC 2 Type II - Compliant
☑ ISO 27001 - Compliant
☑ PCI DSS - Compliant
☑ GDPR - Compliant
☐ Exceptions (list below):
_________________________________________________________________________

Risk Assessment:
----------------
Overall Risk Level: ☐ Low  ☐ Medium  ☐ High
Risk Mitigation: ___________________________________________________________

Approvals:
----------

Security Team Lead:
Name: _________________________    Date: _______________
Signature: _____________________   Email: ______________

☐ Approved    ☐ Approved with Conditions    ☐ Rejected

Comments: ______________________________________________________________
_________________________________________________________________________


CISO (Required for Production):
Name: _________________________    Date: _______________
Signature: _____________________   Email: ______________

☐ Approved    ☐ Approved with Conditions    ☐ Rejected

Comments: ______________________________________________________________
_________________________________________________________________________


Compliance Officer (Required for Annual Review):
Name: _________________________    Date: _______________
Signature: _____________________   Email: ______________

☐ Approved    ☐ Approved with Conditions    ☐ Rejected

Comments: ______________________________________________________________
_________________________________________________________________________

Next Review Scheduled: 2026-04-15

================================================================================
```

## Example: Excel Report Structure

The Excel workbook contains multiple worksheets:

### Sheet 1: Summary
- Review metadata (ID, Date, Type)
- Overall statistics
- Environment breakdown
- Critical findings highlighted in red

### Sheet 2: Users
- All user role assignments
- Columns: DisplayName, SignInName, UPN, Role, Scope, Environment, AccountEnabled
- Conditional formatting for inactive accounts

### Sheet 3: Service Principals
- All service principal assignments
- Columns: DisplayName, ApplicationId, Role, Scope, Environment, SecretExpiration, DaysUntilExpiry
- Conditional formatting for expiring secrets (red < 30 days, yellow < 60 days)

### Sheet 4: High Privilege
- All Owner/Contributor/UAA assignments
- Columns: DisplayName, Type, Role, Scope, Environment
- Service principals highlighted

### Sheet 5: Findings
- All security findings
- Columns: Severity, Type, Principal, Description, RecommendedAction
- Color-coded by severity (Critical = Red, High = Orange, Medium = Yellow, Low = Green)

### Sheet 6: Orphaned
- Orphaned assignments requiring removal
- Columns: DisplayName, ObjectId, Role, Scope, Environment

## File Locations

After running the script, files are created in these locations:

```
infrastructure/arm-templates/access-reviews/
├── reports/
│   ├── access_review_AR-2026-Q1-0214_20260214_101530.json
│   ├── access_review_AR-2026-Q1-0214_20260214_101530_users.csv
│   ├── access_review_AR-2026-Q1-0214_20260214_101530_service_principals.csv
│   ├── access_review_AR-2026-Q1-0214_20260214_101530_high_privilege.csv
│   ├── access_review_AR-2026-Q1-0214_20260214_101530_orphaned.csv
│   ├── access_review_AR-2026-Q1-0214_20260214_101530_findings.csv
│   └── access_review_AR-2026-Q1-0214_20260214_101530.xlsx
├── templates/
│   └── access_review_signoff_AR-2026-Q1-0214.txt
└── logs/
    └── access_review_AR-2026-Q1-0214_20260214_101530.log
```

---

**Document Version:** 1.0.0  
**Last Updated:** 2026-02-14
